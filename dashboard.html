<!DOCTYPE html>
<html>
<head>
<title>Linkarsha Studio</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>

<style>
body{margin:0;font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto;background:#f6f7fb;}
.header{padding:20px 40px;font-weight:700;font-size:20px;background:white;box-shadow:0 2px 10px rgba(0,0,0,0.05);}
.container{display:flex;gap:40px;padding:40px;flex-wrap:wrap;}
.left,.right{background:white;border-radius:20px;padding:25px;box-shadow:0 10px 30px rgba(0,0,0,0.06);}
.left{width:340px;}
.right{flex:1;min-width:300px;}

.previewCard{border-radius:25px;padding:25px;text-align:center;background:#fff;}
.avatar{width:70px;height:70px;border-radius:50%;display:flex;align-items:center;justify-content:center;font-size:26px;margin:auto;margin-bottom:10px;background:#6366f1;color:white;}

.linkbtn{display:block;padding:12px;margin:8px 0;border-radius:12px;text-decoration:none;font-weight:600;background:white;color:#111;box-shadow:0 5px 15px rgba(0,0,0,0.05);}

.featuredPreview{
background:linear-gradient(135deg,#7c3aed,#6366f1);
color:white;
}

.statBox{background:linear-gradient(135deg,#6366f1,#4f46e5);color:white;padding:16px;border-radius:14px;margin-bottom:10px;font-weight:600;}

input{width:100%;padding:12px;margin:8px 0;border-radius:10px;border:1px solid #eee;}
button{padding:8px 12px;border:none;border-radius:8px;background:#6366f1;color:white;font-weight:600;cursor:pointer;margin-left:6px;}

.sectionTitle{font-weight:700;margin-top:15px;margin-bottom:10px;}
.linkRow{display:flex;justify-content:space-between;align-items:center;margin:6px 0;padding:6px 0;border-bottom:1px solid #eee;}
</style>
</head>

<body>

<div class="header">Linkarsha Studio</div>

<div class="container">

<div class="left">
<div class="previewCard">
<div class="avatar" id="avatar">U</div>
<div id="previewUsername">@username</div>
<div id="previewLinks"></div>
</div>
</div>

<div class="right">

<div class="sectionTitle">Add Link</div>
<input id="title" placeholder="Instagram / YouTube">
<input id="url" placeholder="https://">
<button onclick="addLink()">Add Link</button>

<hr style="margin:25px 0">

<div class="sectionTitle">Your Links</div>
<div id="linksList"></div>

</div>
</div>

<script>
const { createClient } = supabase;

const supabaseClient=createClient(
"https://pibrvhziqkaitaacbegy.supabase.co",
"PASTE_ANON_KEY"
);

let userId=null;

async function load(){

const {data:{user}}=await supabaseClient.auth.getUser();
if(!user){location.href="/";return;}
userId=user.id;

const {data:profile}=await supabaseClient
.from("profiles")
.select("*")
.eq("id",user.id)
.single();

document.getElementById("previewUsername").innerText="@"+profile.username;
document.getElementById("avatar").innerText=profile.username.charAt(0).toUpperCase();

loadLinks();
}

async function addLink(){
const title=document.getElementById("title").value;
const url=document.getElementById("url").value;
if(!title||!url)return;

await supabaseClient.from("links").insert([
{user_id:userId,title:title,url:url,featured:false}
]);

document.getElementById("title").value="";
document.getElementById("url").value="";

loadLinks();
}

async function setFeatured(id){

// remove old featured
await supabaseClient
.from("links")
.update({featured:false})
.eq("user_id",userId);

// set new featured
await supabaseClient
.from("links")
.update({featured:true})
.eq("id",id);

loadLinks();
}

async function loadLinks(){

const {data}=await supabaseClient
.from("links")
.select("*")
.eq("user_id",userId)
.order("featured",{ascending:false});

let dashboardHtml="";
let previewHtml="";

data.forEach(l=>{

dashboardHtml+=`
<div class="linkRow">
<div>${l.title} ${l.featured?'⭐':''}</div>
<div>
<button onclick="setFeatured('${l.id}')">⭐</button>
</div>
</div>
`;

if(l.featured){
previewHtml+=`<a class="linkbtn featuredPreview">${l.title}</a>`;
}else{
previewHtml+=`<a class="linkbtn">${l.title}</a>`;
}

});

document.getElementById("linksList").innerHTML=dashboardHtml;
document.getElementById("previewLinks").innerHTML=previewHtml;
}

load();
</script>

</body>
</html>
