<!DOCTYPE html>
<html>
<head>
<title>Linkarsha</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>

<style>
body{
margin:0;
font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto;
min-height:100vh;
display:flex;
justify-content:center;
}

/* default luxury */
body.luxury{
background:#ffffff;
}

/* dark premium */
body.dark{
background:#0e0e0e;
color:white;
}

/* creator pink */
body.creator{
background:linear-gradient(135deg,#ffe4ec,#ffffff);
}

/* minimal */
body.minimal{
background:#f5f5f7;
}

.container{
width:100%;
max-width:520px;
padding:60px 22px;
text-align:center;
}

.avatar{
width:120px;
height:120px;
border-radius:50%;
margin:auto;
background:#111;
display:flex;
align-items:center;
justify-content:center;
color:white;
font-size:40px;
font-weight:600;
background-size:cover;
background-position:center;
margin-bottom:18px;
}

.username{
font-size:24px;
font-weight:700;
}

.bio{
margin-top:8px;
color:#777;
font-size:15px;
}

.links{
margin-top:35px;
}

.link{
display:block;
width:100%;
padding:18px;
margin:14px 0;
border-radius:14px;
background:#f5f5f7;
text-decoration:none;
font-weight:600;
font-size:16px;
color:#111;
}

body.dark .link{
background:#1c1c1c;
color:white;
}

.footer{
margin-top:50px;
font-size:13px;
color:#bbb;
}
</style>
</head>

<body class="luxury">

<div class="container">
<div class="avatar" id="avatar">U</div>
<div class="username" id="username">@user</div>
<div class="bio" id="bio">Creator</div>
<div class="links" id="links"></div>
<div class="footer">Linkarsha</div>
</div>

<script>
const { createClient } = supabase;

const supabaseClient=createClient(
"https://pibrvhziqkaitaacbegy.supabase.co",
"eyJhbGciOiJIUzI1NiIsInT5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InBpYnJ2aHppcWthaXRhYWNiZWd5Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NzE0Mzc3MDQsImV4cCI6MjA4NzAxMzcwNH0.gBi73cyS6exLNfm1iz6IwAzWFXXxFAjgjlnbuHx7HMw"
);

let username = window.location.pathname.replace("/","").toLowerCase();

async function load(){

const {data:profile,error}=await supabaseClient
.from("profiles")
.select("*")
.ilike("username",username)
.single();

if(error || !profile){
document.body.innerHTML="<h2>User not found</h2>";
return;
}

/* APPLY THEME */
document.body.className="";
if(profile.theme){
document.body.classList.add(profile.theme);
}else{
document.body.classList.add("luxury");
}

document.getElementById("username").innerText="@"+profile.username;

if(profile.bio){
document.getElementById("bio").innerText=profile.bio;
}

if(profile.avatar){
document.getElementById("avatar").style.background="url('"+profile.avatar+"')";
document.getElementById("avatar").innerText="";
}else{
document.getElementById("avatar").innerText=profile.username.charAt(0).toUpperCase();
}

const {data:links}=await supabaseClient
.from("links")
.select("*")
.eq("user_id",profile.id);

let html="";
if(links){
links.forEach(l=>{
html+=`<a class="link" href="${l.url}" target="_blank">${l.title}</a>`;
});
}

document.getElementById("links").innerHTML=html;
}

load();
</script>

</body>
</html>
