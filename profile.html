<!DOCTYPE html>
<html>
<head>
<title>Linkarsha</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>

<style>
@import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap');

*{
margin:0;
padding:0;
box-sizing:border-box;
font-family:'Inter',sans-serif;
}

body{
background:#ffffff;
min-height:100vh;
display:flex;
justify-content:center;
}

.container{
width:100%;
max-width:520px;
padding:60px 22px;
}

/* profile */
.profile{
text-align:center;
margin-bottom:40px;
}

.avatar{
width:130px;
height:130px;
border-radius:50%;
margin:auto;
background:#111;
display:flex;
align-items:center;
justify-content:center;
color:white;
font-size:44px;
font-weight:600;
background-size:cover;
background-position:center;
margin-bottom:18px;
}

.username{
font-size:26px;
font-weight:700;
letter-spacing:-0.5px;
}

.bio{
margin-top:8px;
color:#777;
font-size:15px;
}

/* links */
.links{
margin-top:35px;
}

.link{
display:flex;
align-items:center;
justify-content:center;
width:100%;
padding:18px;
margin:14px 0;
border-radius:16px;
background:#f6f7fb;
text-decoration:none;
font-weight:600;
font-size:16px;
color:#111;
transition:0.25s;
}

.link:hover{
background:#111;
color:white;
transform:scale(1.02);
}

/* footer */
.footer{
margin-top:60px;
text-align:center;
font-size:13px;
color:#bbb;
}
</style>
</head>

<body>

<div class="container">

<div class="profile">
<div class="avatar" id="avatar">U</div>
<div class="username" id="username">@user</div>
<div class="bio" id="bio">Creator</div>
</div>

<div class="links" id="links"></div>

<div class="footer">Linkarsha</div>

</div>

<script>
const { createClient } = supabase;

const supabaseClient=createClient(
"https://pibrvhziqkaitaacbegy.supabase.co",
"PASTE_ANON_KEY"
);

let username=window.location.pathname.replace("/","").toLowerCase();

async function load(){

const {data:profile}=await supabaseClient
.from("profiles")
.select("*")
.ilike("username",username)
.single();

if(!profile){
document.body.innerHTML="<h2>User not found</h2>";
return;
}

document.getElementById("username").innerText="@"+profile.username;

if(profile.bio){
document.getElementById("bio").innerText=profile.bio;
}

if(profile.avatar){
document.getElementById("avatar").style.background="url('"+profile.avatar+"')";
document.getElementById("avatar").innerText="";
}else{
document.getElementById("avatar").innerText=profile.username.charAt(0).toUpperCase();
}

const {data:links}=await supabaseClient
.from("links")
.select("*")
.eq("user_id",profile.id);

let html="";
links.forEach(l=>{
html+=`<a class="link" href="${l.url}" target="_blank">${l.title}</a>`;
});

document.getElementById("links").innerHTML=html;
}

load();
</script>

</body>
</html>
