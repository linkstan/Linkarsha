<!DOCTYPE html>
<html>
<head>
<title>Linkarsha</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>

<style>
*{
margin:0;
padding:0;
box-sizing:border-box;
}

body{
font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto;
min-height:100vh;
background:linear-gradient(135deg,#f1f5ff,#ffffff,#eef2ff);
display:flex;
flex-direction:column;
align-items:center;
padding:40px 20px;
}

/* subtle floating background */
body::before{
content:"";
position:fixed;
width:600px;
height:600px;
background:radial-gradient(circle at center,#6366f1 0%,transparent 70%);
top:-200px;
right:-200px;
opacity:0.15;
filter:blur(100px);
z-index:-1;
}

.profile{
width:100%;
max-width:480px;
text-align:center;
}

.avatar{
width:140px;
height:140px;
border-radius:50%;
margin:0 auto 20px;
background:linear-gradient(135deg,#6366f1,#7c3aed);
display:flex;
align-items:center;
justify-content:center;
color:white;
font-size:48px;
font-weight:700;
background-size:cover;
background-position:center;
box-shadow:0 30px 80px rgba(99,102,241,0.35);
}

.username{
font-size:28px;
font-weight:700;
margin-bottom:6px;
}

.bio{
color:#666;
font-size:15px;
margin-bottom:30px;
}

.links{
width:100%;
}

.link{
display:block;
width:100%;
padding:18px;
margin:14px 0;
border-radius:22px;
background:white;
text-decoration:none;
font-weight:600;
color:#111;
font-size:16px;
box-shadow:0 20px 40px rgba(0,0,0,0.08);
transition:all 0.25s ease;
}

.link:hover{
transform:translateY(-4px);
box-shadow:0 30px 60px rgba(0,0,0,0.15);
}

.footer{
margin-top:40px;
font-size:13px;
color:#aaa;
}
</style>
</head>

<body>

<div class="profile">
<div class="avatar" id="avatar">U</div>
<div class="username" id="username">@user</div>
<div class="bio" id="bio">Creator</div>
<div class="links" id="links"></div>
<div class="footer">Powered by Linkarsha</div>
</div>

<script>
const { createClient } = supabase;

const supabaseClient=createClient(
"https://pibrvhziqkaitaacbegy.supabase.co",
"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InBpYnJ2aHppcWthaXRhYWNiZWd5Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NzE0Mzc3MDQsImV4cCI6MjA4NzAxMzcwNH0.gBi73cyS6exLNfm1iz6IwAzWFXXxFAjgjlnbuHx7HMw"
);

let username=window.location.pathname.replace("/","").toLowerCase();

async function load(){

const {data:profile}=await supabaseClient
.from("profiles")
.select("*")
.ilike("username",username)
.single();

if(!profile){
document.body.innerHTML="<h2>User not found</h2>";
return;
}

document.getElementById("username").innerText="@"+profile.username;

if(profile.bio){
document.getElementById("bio").innerText=profile.bio;
}

if(profile.avatar){
document.getElementById("avatar").style.background="url('"+profile.avatar+"')";
document.getElementById("avatar").innerText="";
}else{
document.getElementById("avatar").innerText=profile.username.charAt(0).toUpperCase();
}

const {data:links}=await supabaseClient
.from("links")
.select("*")
.eq("user_id",profile.id);

let html="";
links.forEach(l=>{
html+=`<a class="link" href="${l.url}" target="_blank">${l.title}</a>`;
});

document.getElementById("links").innerHTML=html;
}

load();
</script>

</body>
</html>
